{% extends "auth_base.html" %}

{% block title %}é‚®ç®±éªŒè¯ - Trend-Autostop{% endblock %}

{% block content %}
<div class="auth-card" style="text-align: center;">
    {% if success %}
    <div style="font-size: 64px; margin-bottom: 20px;">âœ…</div>
    <h2 class="auth-title">é‚®ç®±éªŒè¯æˆåŠŸ</h2>
    <p style="color: var(--text-secondary); margin-bottom: 24px;">
        æ‚¨çš„é‚®ç®±å·²æˆåŠŸéªŒè¯ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½ã€‚
    </p>
    <a href="/auth/login" class="btn btn-primary">å‰å¾€ç™»å½•</a>
    
    {% elif error %}
    <div style="font-size: 64px; margin-bottom: 20px;">âŒ</div>
    <h2 class="auth-title">éªŒè¯å¤±è´¥</h2>
    <p style="color: var(--text-secondary); margin-bottom: 24px;">
        {{ error }}
    </p>
    <a href="/auth/login" class="btn btn-primary">è¿”å›ç™»å½•</a>
    
    {% else %}
    <div style="font-size: 64px; margin-bottom: 20px;">ğŸ“§</div>
    <h2 class="auth-title">éªŒè¯ä¸­...</h2>
    <p style="color: var(--text-secondary); margin-bottom: 24px;">
        æ­£åœ¨éªŒè¯æ‚¨çš„é‚®ç®±ï¼Œè¯·ç¨å€™...
    </p>
    <div class="loading" style="display: block; margin: 0 auto;"></div>
    {% endif %}
</div>

{% endblock %}

{% block extra_js %}
{% if not success and not error and token %}
<script>
// Auto-verify on page load
(async function() {
    try {
        const response = await fetch('/api/auth/verify-email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                token: '{{ token }}'
            })
        });
        
        if (response.ok) {
            window.location.href = '/auth/verify-email?success=1';
        } else {
            const data = await response.json();
            window.location.href = '/auth/verify-email?error=' + encodeURIComponent(data.detail || 'éªŒè¯å¤±è´¥');
        }
    } catch (error) {
        window.location.href = '/auth/verify-email?error=' + encodeURIComponent('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
    }
})();
</script>
{% endif %}
{% endblock %}

